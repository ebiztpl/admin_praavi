import{u as H,s as S,t as K,r as d,o as u,k as p,l as e,e as w,v as i,x as a,d as f,f as s,m as Q,h as W,A as X,p as _,y as T,b as n,n as Y,a as F,z as Z,F as x,R as ee}from"./app.537b83f5.js";const te={class:"grid grid-cols-3 gap-6"},ae={class:"col-span-3 sm:col-span-1"},ne={class:"col-span-3 sm:col-span-1"},se={__name:"Filter",emits:["hide"],setup(N,{emit:h}){const v=H(),A={employees:[],startDate:"",endDate:""},m=S({...A}),k=S({employees:[],isLoaded:!v.query.employees});return K(async()=>{k.employees=v.query.employees?v.query.employees.split(","):[],k.isLoaded=!0}),($,c)=>{const g=d("BaseSelectSearch"),D=d("DatePicker"),b=d("FilterForm");return u(),p(b,{"init-form":A,form:m,multiple:["employees"],onHide:c[3]||(c[3]=l=>h("hide"))},{default:e(()=>[w("div",te,[w("div",ae,[k.isLoaded?(u(),p(g,{key:0,multiple:"",name:"employees",label:$.$trans("global.select",{attribute:$.$trans("employee.employee")}),modelValue:m.employees,"onUpdate:modelValue":c[0]||(c[0]=l=>m.employees=l),"value-prop":"uuid","init-search":k.employees,"search-key":"name","search-action":"employee/list"},{selectedOption:e(l=>[i(a(l.value.name)+" ("+a(l.value.codeNumber)+") ",1)]),listOption:e(l=>[i(a(l.option.name)+" ("+a(l.option.codeNumber)+") ",1)]),_:1},8,["label","modelValue","init-search"])):f("",!0)]),w("div",ne,[s(D,{start:m.startDate,"onUpdate:start":c[1]||(c[1]=l=>m.startDate=l),end:m.endDate,"onUpdate:end":c[2]||(c[2]=l=>m.endDate=l),name:"dateBetween",as:"range",label:$.$trans("general.date_between")},null,8,["start","end","label"])])])]),_:1},8,["form"])}}},oe={key:1,class:"text-xs text-danger"},ie={key:0},le=w("i",{class:"fas fa-check-circle text-success"},null,-1),re=[le],de={name:"AttendanceTimesheetList"},me=Object.assign(de,{setup(N){const h=H(),v=Q(),A=W(),m=X("emitter");let k=["filter"];_("timesheet:create")&&k.unshift("create");let $=[];_("timesheet:export")&&($=["print","pdf","excel"]),_("timesheet:import")&&$.unshift("import");const c="attendance/timesheet/",g=T(!1),D=T(!1),b=T(!1),l=S({}),R=r=>{Object.assign(l,r)},V=async()=>{g.value||!await ee()||(g.value=!0,await A.dispatch(c+"sync",{params:h.query}).then(r=>{g.value=!1,m.emit("listItems")}).catch(r=>{g.value=!1}))};return(r,o)=>{const q=d("BaseButton"),M=d("PageHeaderAction"),P=d("PageHeader"),O=d("BaseImport"),I=d("ParentTransition"),U=d("BaseAlert"),y=d("DataCell"),j=d("BaseBadge"),C=d("FloatingMenuItem"),z=d("FloatingMenu"),E=d("DataRow"),G=d("DataTable"),J=d("ListItem");return u(),p(J,{"init-url":c,onSetItems:R},{header:e(()=>[s(P,{title:r.$trans("attendance.timesheet.timesheet"),navs:[{label:r.$trans("attendance.attendance"),path:"Attendance"}]},{default:e(()=>[s(M,{url:"attendance/timesheets/",name:"AttendanceTimesheet",title:r.$trans("attendance.timesheet.timesheet"),actions:n(k),"dropdown-actions":n($),onToggleFilter:o[0]||(o[0]=t=>D.value=!D.value),onToggleImport:o[1]||(o[1]=t=>b.value=!b.value)},{default:e(()=>[n(_)("timesheet:sync")&&n(h).query.startDate&&n(h).query.endDate?(u(),p(q,{key:0,design:"white",onClick:V,disabled:g.value},{default:e(()=>[w("i",{class:Y(["fas fa-rotate mr-2",{"fa-spin":g.value}])},null,2),i(" "+a(r.$trans("global.sync",{attribute:r.$trans("attendance.timesheet.timesheet")})),1)]),_:1},8,["disabled"])):f("",!0)]),_:1},8,["title","actions","dropdown-actions"])]),_:1},8,["title","navs"])]),import:e(()=>[s(I,{appear:"",visibility:b.value},{default:e(()=>[s(O,{path:"attendance/timesheets/import",onCancelled:o[2]||(o[2]=t=>b.value=!1),onHide:o[3]||(o[3]=t=>b.value=!1),onCompleted:o[4]||(o[4]=t=>n(m).emit("listItems"))})]),_:1},8,["visibility"])]),filter:e(()=>[s(I,{appear:"",visibility:D.value},{default:e(()=>[s(se,{onRefresh:o[5]||(o[5]=t=>n(m).emit("listItems")),onHide:o[6]||(o[6]=t=>D.value=!1)})]),_:1},8,["visibility"])]),"after-filter":e(()=>[n(_)("timesheet:sync")&&(!n(h).query.startDate||!n(h).query.endDate)?(u(),p(U,{key:0,design:"info",size:"xs"},{default:e(()=>[i(a(r.$trans("attendance.timesheet.choose_date_range_to_sync")),1)]),_:1})):f("",!0)]),default:e(()=>[s(I,{appear:"",visibility:!0},{default:e(()=>[s(G,{header:l.headers,meta:l.meta,module:"attendance.timesheet",onRefresh:o[8]||(o[8]=t=>n(m).emit("listItems"))},{actionButton:e(()=>[n(_)("timesheet:create")?(u(),p(q,{key:0,onClick:o[7]||(o[7]=t=>n(v).push({name:"AttendanceTimesheetCreate"}))},{default:e(()=>[i(a(r.$trans("global.add",{attribute:r.$trans("attendance.timesheet.timesheet")})),1)]),_:1})):f("",!0)]),default:e(()=>[(u(!0),F(x,null,Z(l.data,t=>(u(),p(E,{key:t.uuid},{default:e(()=>[s(y,{name:"employee"},{default:e(()=>[i(a(t.employee.name)+" ("+a(t.employee.codeNumber)+") ",1)]),_:2},1024),s(y,{name:"designation"},{default:e(()=>[i(a(t.employee.designation),1)]),_:2},1024),s(y,{name:"branch"},{default:e(()=>[i(a(t.employee.branch),1)]),_:2},1024),s(y,{name:"workShift"},{default:e(()=>{var B,L;return[i(a((B=t.workShift)==null?void 0:B.name)+" ("+a((L=t.workShift)==null?void 0:L.code)+") ",1)]}),_:2},1024),s(y,{name:"date"},{default:e(()=>[i(a(t.dateDisplay)+" ",1),t.isManual?(u(),p(j,{key:0,type:"info"},{default:e(()=>[i(a(r.$trans("attendance.timesheet.props.manual")),1)]),_:1})):f("",!0),t.status&&t.status!="ok"?(u(),F("div",oe,a(t.statusDetail.label),1)):f("",!0)]),_:2},1024),s(y,{name:"inAt"},{default:e(()=>[i(a(t.inAtTimeDisplay),1)]),_:2},1024),s(y,{name:"outAt"},{default:e(()=>[i(a(t.outAtTimeDisplay),1)]),_:2},1024),s(y,{name:"duration"},{default:e(()=>[i(a(t.duration)+" ",1),t.status=="ok"?(u(),F("span",ie,re)):f("",!0)]),_:2},1024),s(y,{name:"action"},{default:e(()=>[s(z,null,{default:e(()=>[s(C,{icon:"fas fa-arrow-circle-right",onClick:B=>n(v).push({name:"AttendanceTimesheetShow",params:{uuid:t.uuid}})},{default:e(()=>[i(a(r.$trans("general.show")),1)]),_:2},1032,["onClick"]),n(_)("timesheet:edit")&&t.isEditable?(u(),p(C,{key:0,icon:"fas fa-edit",onClick:B=>n(v).push({name:"AttendanceTimesheetEdit",params:{uuid:t.uuid}})},{default:e(()=>[i(a(r.$trans("general.edit")),1)]),_:2},1032,["onClick"])):f("",!0),n(_)("timesheet:create")?(u(),p(C,{key:1,icon:"fas fa-copy",onClick:B=>n(v).push({name:"AttendanceTimesheetDuplicate",params:{uuid:t.uuid}})},{default:e(()=>[i(a(r.$trans("general.duplicate")),1)]),_:2},1032,["onClick"])):f("",!0),n(_)("timesheet:delete")&&t.isDeletable?(u(),p(C,{key:2,icon:"fas fa-trash",onClick:B=>n(m).emit("deleteItem",{uuid:t.uuid})},{default:e(()=>[i(a(r.$trans("general.delete")),1)]),_:2},1032,["onClick"])):f("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["header","meta"])]),_:1})]),_:1})}}});export{me as default};
