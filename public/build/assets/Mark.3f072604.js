import{u as J,m as K,h as Q,y as W,s as T,q as X,t as Y,r as n,j as Z,o as s,a as f,f as o,l as a,b as r,k as u,d as y,F as V,I as x,v as p,x as d,z as C,e as v,w as ee}from"./app.537b83f5.js";import{_ as te}from"./Filter.6e803d1b.js";const ae={class:"p-2"},ne={class:"divide-y divide-gray-200 dark:divide-gray-700"},se={class:"col-span-3 sm:col-span-1"},oe={key:0,class:"ml-2"},re=v("i",{class:"fas fa-clock text-info"},null,-1),de=[re],le={class:"col-span-3 sm:col-span-1"},ie={class:"col-span-3 sm:col-span-1"},ce={name:"AttendanceMark"},_e=Object.assign(ce,{setup(ue){const g=J(),w=K(),U=Q(),k={employees:[]},h="attendance/",B=W(!1),b=T({attendanceTypes:[]}),$=X(h),m=T({...k}),_=T({meta:{},defaultAttendanceType:{}}),q=e=>{_.defaultAttendanceType=e,m.employees.forEach(l=>{l.timeBasedAttendance||(l.attendanceType=e.uuid)})},A=async()=>{B.value=!0,await U.dispatch(h+"fetchEmployee",{params:g.query}).then(e=>{B.value=!1,k.employees=e.data,_.meta=e.meta,Object.assign(m,x(k))}).catch(e=>{B.value=!1})},F=e=>{Object.assign(b,e)};return Y(async()=>{g.query.date&&await A()}),(e,l)=>{const P=n("BaseButton"),E=n("PageHeaderAction"),R=n("PageHeader"),N=n("ParentTransition"),S=n("DropdownItem"),j=n("DropdownButton"),H=n("BaseAlert"),D=n("BaseDataView"),L=n("BaseSelect"),I=n("BaseTextarea"),O=n("FormAction"),z=n("Pagination"),M=n("BaseCard"),G=Z("tooltip");return s(),f(V,null,[o(R,{title:e.$trans(r(g).meta.label),navs:[{label:e.$trans("attendance.attendance"),path:"Attendance"}]},{default:a(()=>[o(E,null,{default:a(()=>[o(P,{design:"white",onClick:l[0]||(l[0]=t=>r(w).push({name:"AttendanceList"}))},{default:a(()=>[p(d(e.$trans("global.list",{attribute:e.$trans("attendance.attendance")})),1)]),_:1}),o(P,{design:"primary",onClick:l[1]||(l[1]=t=>r(w).push({name:"AttendanceProduction"}))},{default:a(()=>[p(d(e.$trans("attendance.mark_production")),1)]),_:1})]),_:1})]),_:1},8,["title","navs"]),o(N,{appear:"",visibility:!0},{default:a(()=>[o(te,{onAfterFilter:A,"init-url":h})]),_:1}),r(g).query.date?(s(),u(M,{key:0,"no-padding":"","no-content-padding":"","is-loading":B.value},{title:a(()=>[p(d(e.$trans("attendance.mark")),1)]),action:a(()=>[b.attendanceTypes?(s(),u(j,{key:0,label:_.defaultAttendanceType.uuid?_.defaultAttendanceType.name:e.$trans("attendance.type.type")},{default:a(()=>[(s(!0),f(V,null,C(b.attendanceTypes,t=>(s(),f("div",{key:t.uuid},[t.uuid!=_.defaultAttendanceType.name?(s(),u(S,{key:0,as:"span",onClick:i=>q(t)},{default:a(()=>[p(d(t.name),1)]),_:2},1032,["onClick"])):y("",!0)]))),128))]),_:1},8,["label"])):y("",!0)]),default:a(()=>[v("div",ae,[m.employees.length==0?(s(),u(H,{key:0,size:"xs",design:"error"},{default:a(()=>[p(d(e.$trans("general.errors.record_not_found")),1)]),_:1})):y("",!0)]),m.employees.length?(s(),u(O,{key:0,"no-card":"","button-padding":"","keep-adding":!1,"stay-on":!0,"init-url":h,"pre-requisites":!0,onSetPreRequisites:F,action:"markAttendance","init-form":k,form:m},{default:a(()=>[v("div",ne,[(s(!0),f(V,null,C(m.employees,(t,i)=>(s(),f("div",{class:"grid grid-cols-3 gap-6 px-4 py-2",key:t.uuid},[v("div",se,[o(D,{label:t.name+" ("+t.codeNumber+")",revert:""},{default:a(()=>[p(d(t.designation)+" "+d(t.branch)+" ",1),t.timeBasedAttendance?ee((s(),f("span",oe,de)),[[G,e.$trans("attendance.is_time_based")]]):y("",!0)]),_:2},1032,["label"])]),v("div",le,[t.onLeave?(s(),u(D,{key:0,label:e.$trans("leave.on_leave"),revert:""},{default:a(()=>[p(d(t.leavePeriod),1)]),_:2},1032,["label"])):(s(),u(L,{key:1,disabled:t.timeBasedAttendance,modelValue:t.attendanceType,"onUpdate:modelValue":c=>t.attendanceType=c,name:`employees.${i}.attendanceType`,placeholder:e.$trans("attendance.type.type"),options:b.attendanceTypes,"value-prop":"uuid","label-prop":"name",error:r($)[`employees.${i}.attendanceType`],"onUpdate:error":c=>r($)[`employees.${i}.attendanceType`]=c},null,8,["disabled","modelValue","onUpdate:modelValue","name","placeholder","options","error","onUpdate:error"]))]),v("div",ie,[o(I,{rows:1,modelValue:t.remarks,"onUpdate:modelValue":c=>t.remarks=c,name:`employees.${i}.remarks`,placeholder:e.$trans("attendance.props.remarks"),error:r($)[`details.${i}.remarks`],"onUpdate:error":c=>r($)[`details.${i}.remarks`]=c},null,8,["modelValue","onUpdate:modelValue","name","placeholder","error","onUpdate:error"])])]))),128))])]),_:1},8,["form"])):y("",!0),o(z,{meta:_.meta,onRefresh:A},null,8,["meta"])]),_:1},8,["is-loading"])):y("",!0)],64)}}});export{_e as default};
